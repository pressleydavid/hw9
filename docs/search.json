[
  {
    "objectID": "hw9.html",
    "href": "hw9.html",
    "title": "Homework 9",
    "section": "",
    "text": "[1] \"Date\"                      \"Rented Bike Count\"        \n [3] \"Hour\"                      \"Temperature(°C)\"          \n [5] \"Humidity(%)\"               \"Wind speed (m/s)\"         \n [7] \"Visibility (10m)\"          \"Dew point temperature(°C)\"\n [9] \"Solar Radiation (MJ/m2)\"   \"Rainfall(mm)\"             \n[11] \"Snowfall (cm)\"             \"Seasons\"                  \n[13] \"Holiday\"                   \"Functioning Day\"          \n\n\n [1] \"date\"                    \"rented_bike_count\"      \n [3] \"hour\"                    \"temperature_c\"          \n [5] \"humidity_percent\"        \"wind_speed_m_s\"         \n [7] \"visibility_10m\"          \"dew_point_temperature_c\"\n [9] \"solar_radiation_mj_m2\"   \"rainfall_mm\"            \n[11] \"snowfall_cm\"             \"seasons\"                \n[13] \"holiday\"                 \"functioning_day\"        \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#Basic EDA\n#Missing values\nmissing_summ &lt;- soul_bikes |&gt;\n  summarize(across(everything(), \\(x) sum(is.na(x)))) |&gt;\n  pivot_longer(everything(),\n                names_to = \"variable\",\n                values_to = \"missing_count\")\nmissing_summ\n\n# A tibble: 14 × 2\n   variable                  missing_count\n   &lt;chr&gt;                             &lt;int&gt;\n 1 Date                                  0\n 2 Rented Bike Count                     0\n 3 Hour                                  0\n 4 Temperature(°C)                       0\n 5 Humidity(%)                           0\n 6 Wind speed (m/s)                      0\n 7 Visibility (10m)                      0\n 8 Dew point temperature(°C)             0\n 9 Solar Radiation (MJ/m2)               0\n10 Rainfall(mm)                          0\n11 Snowfall (cm)                         0\n12 Seasons                               0\n13 Holiday                               0\n14 Functioning Day                       0\n\n#By variable summary stats for numerics\nbike_summ_nums &lt;- soul_bikes_functioning |&gt;\n  select(where(is.numeric)) |&gt;\n  summarize(across(everything(),\n                   list(\n                     mean = \\(x) mean(x, na.rm = TRUE),\n                     sd = \\(x) sd(x, na.rm = TRUE),\n                     median = \\(x) median(x, na.rm = TRUE),\n                     iqr = \\(x) IQR(x, na.rm = TRUE),\n                     min = \\(x) min(x, na.rm = TRUE),\n                     max = \\(x) max(x, na.rm = TRUE),\n                     n_missing = \\(x) sum(is.na(x))\n                   ))) |&gt;\n              pivot_longer(\n                everything(),\n                names_to = c(\"column\", \"stat\"),\n                names_pattern = \"(.*)_(.*)\",\n                values_to = \"values\"\n              )\n\n#By variable summary stats for character/factor\nbike_summ_cats &lt;- soul_bikes_functioning |&gt;\n  select(where(is.character), where(is.factor)) |&gt;\n  summarize(across(everything(),\n    list(\n      n_unique = \\(x) n_distinct(x),\n      n_missing = \\(x) sum(is.na(x))\n    )\n  )) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = c(\"column\", \"stat\"),\n    names_pattern = \"(.*)_(.*)\",\n    values_to = \"value\"\n  )\n\n# Factor levels summary\nfactor_levels &lt;- soul_bikes_functioning |&gt;\n  select(where(is.factor), where(is.character)) |&gt;\n  summarize(across(everything(), \\(x) list(sort(unique(x))))) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = \"column\",\n    values_to = \"levels\"\n  ) |&gt;\n  mutate(\n    n_levels = map_int(levels, length),\n    levels = map_chr(levels, toString)\n  )\n\n#7. Summarize across hours\ndaily_summ &lt;- soul_bikes_functioning |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(\n    #totals\n    total_bikes = sum(rented_bike_count),\n    total_rainfall = sum(rainfall_mm),\n    total_snowfall = sum(snowfall_cm),\n\n    #weather means\n    avg_temp = mean(temperature_c),\n    avg_humidity = mean(humidity_percent),\n    avg_wind_speed = mean(wind_speed_m_s),\n    avg_visibility = mean(visibility_10m),\n    avg_dew_point = mean(dew_point_temperature_c),\n    avg_solar_rad = mean(solar_radiation_mj_m2),\n    .groups = \"drop\"  # Drop grouping after summary\n  )\ndaily_summ\n\n# A tibble: 353 × 12\n   date       seasons holiday total_bikes total_rainfall total_snowfall avg_temp\n   &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;         &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;\n 1 2017-12-01 Winter  No Hol…        9539            0              0    -2.45  \n 2 2017-12-02 Winter  No Hol…        8523            0              0     1.32  \n 3 2017-12-03 Winter  No Hol…        7222            4              0     4.88  \n 4 2017-12-04 Winter  No Hol…        8729            0.1            0    -0.304 \n 5 2017-12-05 Winter  No Hol…        8307            0              0    -4.46  \n 6 2017-12-06 Winter  No Hol…        6669            1.3            8.6   0.0458\n 7 2017-12-07 Winter  No Hol…        8549            0             10.4   1.09  \n 8 2017-12-08 Winter  No Hol…        8032            0              0    -3.82  \n 9 2017-12-09 Winter  No Hol…        7233            0              0    -0.846 \n10 2017-12-10 Winter  No Hol…        3453            4.1           32.5   1.19  \n# ℹ 343 more rows\n# ℹ 5 more variables: avg_humidity &lt;dbl&gt;, avg_wind_speed &lt;dbl&gt;,\n#   avg_visibility &lt;dbl&gt;, avg_dew_point &lt;dbl&gt;, avg_solar_rad &lt;dbl&gt;\n\n#Summaries of numerics\nbike_summ_nums &lt;- daily_summ |&gt;\n  select(where(is.numeric)) |&gt;\n  summarize(across(everything(),\n                   list(\n                     mean = \\(x) mean(x, na.rm = TRUE),\n                     sd = \\(x) sd(x, na.rm = TRUE),\n                     median = \\(x) median(x, na.rm = TRUE),\n                     iqr = \\(x) IQR(x, na.rm = TRUE),\n                     min = \\(x) min(x, na.rm = TRUE),\n                     max = \\(x) max(x, na.rm = TRUE),\n                     n_missing = \\(x) sum(is.na(x))\n                   ))) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = c(\"column\", \"stat\"),\n    names_pattern = \"(.*)_(.*)\",\n    values_to = \"values\"\n  )\nbike_summ_nums\n\n# A tibble: 63 × 3\n   column         stat      values\n   &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;\n 1 total_bikes    mean    17485.  \n 2 total_bikes    sd       9937.  \n 3 total_bikes    median  18563   \n 4 total_bikes    iqr     19318   \n 5 total_bikes    min       977   \n 6 total_bikes    max     36149   \n 7 total_bikes_n  missing     0   \n 8 total_rainfall mean        3.58\n 9 total_rainfall sd         11.8 \n10 total_rainfall median      0   \n# ℹ 53 more rows\n\n\n\n\n\n\n\n\n\n\n\n\n# Calculate correlation matrix\ncor_matrix &lt;- daily_summ |&gt;\n  select(total_bikes, avg_temp, avg_humidity, avg_wind_speed,\n         avg_visibility, avg_solar_rad, total_rainfall, total_snowfall) |&gt;\n  cor(use = \"complete.obs\")\ncor_matrix\n\n               total_bikes     avg_temp avg_humidity avg_wind_speed\ntotal_bikes     1.00000000  0.753076732   0.03588697    -0.19288142\navg_temp        0.75307673  1.000000000   0.40416749    -0.26072179\navg_humidity    0.03588697  0.404167486   1.00000000    -0.23425778\navg_wind_speed -0.19288142 -0.260721792  -0.23425778     1.00000000\navg_visibility  0.16599375  0.002336683  -0.55917733     0.20602264\navg_solar_rad   0.73589290  0.550274301  -0.27444967     0.09612635\ntotal_rainfall -0.23910905  0.144517274   0.52864263    -0.10167578\ntotal_snowfall -0.26529110 -0.266963662   0.06539191     0.02088156\n               avg_visibility avg_solar_rad total_rainfall total_snowfall\ntotal_bikes       0.165993749    0.73589290    -0.23910905    -0.26529110\navg_temp          0.002336683    0.55027430     0.14451727    -0.26696366\navg_humidity     -0.559177334   -0.27444967     0.52864263     0.06539191\navg_wind_speed    0.206022636    0.09612635    -0.10167578     0.02088156\navg_visibility    1.000000000    0.27139591    -0.22199387    -0.10188902\navg_solar_rad     0.271395906    1.00000000    -0.32270413    -0.23343056\ntotal_rainfall   -0.221993866   -0.32270413     1.00000000    -0.02313404\ntotal_snowfall   -0.101889019   -0.23343056    -0.02313404     1.00000000\n\n# Create correlation plot\ncorrplot(cor_matrix,\n         method = \"color\",\n         type = \"upper\",\n         addCoef.col = \"black\",\n         tl.col = \"black\",\n         tl.srt = 45,\n         diag = FALSE)\n\n\n\n\n\n\n\n# Individual scatter plots with trend lines\ntemp_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_temp, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"red\") +\n  labs(title = \"Temperature vs Bike Rentals\",\n       x = \"Average Temperature (°C)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nhumid_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_humidity, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"blue\") +\n  labs(title = \"Humidity vs Bike Rentals\",\n       x = \"Average Humidity (%)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nsun_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_solar_rad, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"orange\") +\n  labs(title = \"Solar Radiation vs Bike Rentals\",\n       x = \"Average Solar Radiation (MJ/m2)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nvis_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_visibility, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"green4\") +\n  labs(title = \"Visibility vs Bike Rentals\",\n       x = \"Average Visibility (10m)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\n# Arrange plots in a grid\n\ngrid.arrange(temp_v_rentals, humid_v_rentals, sun_v_rentals, vis_v_rentals, ncol = 2)\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRows: 263\nColumns: 15\n$ date               &lt;date&gt; 2018-09-05, 2018-09-06, 2018-09-07, 2018-09-08, 20…\n$ total_rainfall     &lt;dbl&gt; -0.2970185, -0.2970185, -0.1773679, -0.2970185, -0.…\n$ total_snowfall     &lt;dbl&gt; -0.2179228, -0.2179228, -0.2179228, -0.2179228, -0.…\n$ avg_temp           &lt;dbl&gt; 0.942813132, 0.977863864, 0.800131869, 0.760478516,…\n$ avg_humidity       &lt;dbl&gt; 0.21420205, 0.81794255, -0.11561916, -0.66625286, -…\n$ avg_wind_speed     &lt;dbl&gt; 1.32331031, 0.28870706, 1.28079237, -0.10104074, -0…\n$ avg_visibility     &lt;dbl&gt; 1.05187245, 0.41451440, 0.84111295, 1.10774745, 1.1…\n$ avg_dew_point      &lt;dbl&gt; 0.87630133, 1.09270791, 0.66181269, 0.44380783, 0.4…\n$ avg_solar_rad      &lt;dbl&gt; 1.17578189, -0.32588618, 0.79740883, 1.21388195, 1.…\n$ total_bikes        &lt;dbl&gt; 31114, 27838, 30381, 29813, 28354, 30781, 31809, 30…\n$ seasons_Spring     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ seasons_Summer     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ seasons_Winter     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ holiday_No.Holiday &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, …\n$ weekend_weekend    &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, …\n\n\nRows: 263\nColumns: 25\n$ date                                           &lt;date&gt; 2018-09-05, 2018-09-06…\n$ total_rainfall                                 &lt;dbl&gt; -0.2970185, -0.2970185,…\n$ total_snowfall                                 &lt;dbl&gt; -0.2179228, -0.2179228,…\n$ avg_temp                                       &lt;dbl&gt; 0.942813132, 0.97786386…\n$ avg_humidity                                   &lt;dbl&gt; 0.21420205, 0.81794255,…\n$ avg_wind_speed                                 &lt;dbl&gt; 1.32331031, 0.28870706,…\n$ avg_visibility                                 &lt;dbl&gt; 1.05187245, 0.41451440,…\n$ avg_dew_point                                  &lt;dbl&gt; 0.87630133, 1.09270791,…\n$ avg_solar_rad                                  &lt;dbl&gt; 1.17578189, -0.32588618…\n$ total_bikes                                    &lt;dbl&gt; 31114, 27838, 30381, 29…\n$ seasons_Spring                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ holiday_No.Holiday                             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1,…\n$ weekend_weekend                                &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0,…\n$ seasons_Spring_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Spring_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Spring_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ total_rainfall_x_avg_temp                      &lt;dbl&gt; -0.280032902, -0.290443…\n\n\nRows: 263\nColumns: 29\n$ date                                &lt;date&gt; 2018-09-05, 2018-09-06, 2018-09-0…\n$ total_snowfall                      &lt;dbl&gt; -0.2179228, -0.2179228, -0.2179228…\n$ total_bikes                         &lt;dbl&gt; 31114, 27838, 30381, 29813, 28354,…\n$ seasons_Spring                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ holiday_No.Holiday                  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ weekend_weekend                     &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0…\n$ seasons_Spring_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Spring_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ avg_temp_x_total_rainfall           &lt;dbl&gt; -0.280032902, -0.290443616, -0.141…\n$ total_rainfall_poly_1               &lt;dbl&gt; -0.018349862, -0.018349862, -0.010…\n$ total_rainfall_poly_2               &lt;dbl&gt; 0.017787545, 0.017787545, -0.00247…\n$ avg_temp_poly_1                     &lt;dbl&gt; 0.0582471898, 0.0604126312, 0.0494…\n$ avg_temp_poly_2                     &lt;dbl&gt; 4.343638e-03, 8.936806e-03, -1.277…\n$ avg_humidity_poly_1                 &lt;dbl&gt; 0.013233447, 0.050532660, -0.00714…\n$ avg_humidity_poly_2                 &lt;dbl&gt; -0.049710700, -0.025703529, -0.047…\n$ avg_wind_speed_poly_1               &lt;dbl&gt; 0.081754384, 0.017836382, 0.079127…\n$ avg_wind_speed_poly_2               &lt;dbl&gt; -0.022889314, -0.051814842, -0.025…\n$ avg_visibility_poly_1               &lt;dbl&gt; 0.064984897, 0.025608785, 0.051964…\n$ avg_visibility_poly_2               &lt;dbl&gt; 0.052485925, -0.039054487, 0.01602…\n$ avg_dew_point_poly_1                &lt;dbl&gt; 0.054138077, 0.067507720, 0.040886…\n$ avg_dew_point_poly_2                &lt;dbl&gt; 0.0010118908, 0.0310969311, -0.023…\n$ avg_solar_rad_poly_1                &lt;dbl&gt; 0.072640048, -0.020133316, 0.04926…\n$ avg_solar_rad_poly_2                &lt;dbl&gt; 0.008080770, -0.053656723, -0.0353…\n\n\n# A tibble: 3 × 7\n  .metric .estimator  mean     n std_err .config              model  \n  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;  \n1 rmse    standard   2946.    10    236. Preprocessor1_Model1 Model 3\n2 rmse    standard   3460.    10    475. Preprocessor1_Model1 Model 2\n3 rmse    standard   4151.    10    150. Preprocessor1_Model1 Model 1\n\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard    2913.    Preprocessor1_Model1\n2 rsq     standard       0.919 Preprocessor1_Model1\n\n\n# A tibble: 28 × 5\n   term                                estimate std.error statistic  p.value\n   &lt;chr&gt;                                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                           15335.     2200.     6.97  3.17e-11\n 2 total_snowfall                         -152.      215.    -0.707 4.80e- 1\n 3 seasons_Spring                        -6645.     3740.    -1.78  7.69e- 2\n 4 seasons_Summer                        17050.     3548.     4.81  2.76e- 6\n 5 seasons_Winter                        -7253.     3203.    -2.26  2.45e- 2\n 6 holiday_No.Holiday                     6230.     2074.     3.00  2.96e- 3\n 7 weekend_weekend                       -2445.      394.    -6.20  2.50e- 9\n 8 seasons_Spring_x_holiday_No.Holiday    1843.     3777.     0.488 6.26e- 1\n 9 seasons_Summer_x_holiday_No.Holiday   -2830.     2908.    -0.973 3.31e- 1\n10 seasons_Winter_x_holiday_No.Holiday   -4336.     2470.    -1.76  8.04e- 2\n# ℹ 18 more rows\n\n\n\n\n\n\n\n\n\n\n# A tibble: 27 × 3\n   term                                estimate      penalty\n   &lt;chr&gt;                                  &lt;dbl&gt;        &lt;dbl&gt;\n 1 (Intercept)                           15595. 0.0000000001\n 2 total_rainfall                        -1891. 0.0000000001\n 3 total_snowfall                         -174. 0.0000000001\n 4 seasons_Spring                        -7249. 0.0000000001\n 5 seasons_Summer                        16954. 0.0000000001\n 6 seasons_Winter                        -6042. 0.0000000001\n 7 holiday_No.Holiday                     6241. 0.0000000001\n 8 weekend_weekend                       -2482. 0.0000000001\n 9 seasons_Spring_x_holiday_No.Holiday    2278. 0.0000000001\n10 seasons_Summer_x_holiday_No.Holiday   -2712. 0.0000000001\n# ℹ 17 more rows\n\n\n\n\n\n\n\n\n# A tibble: 100 × 8\n   cost_complexity tree_depth .metric .estimator     mean     n  std_err .config\n             &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;  \n 1    0.0000000001          1 rmse    standard   6767.       10 224.     Prepro…\n 2    0.0000000001          1 rsq     standard      0.539    10   0.0233 Prepro…\n 3    0.000000001           1 rmse    standard   6767.       10 224.     Prepro…\n 4    0.000000001           1 rsq     standard      0.539    10   0.0233 Prepro…\n 5    0.00000001            1 rmse    standard   6767.       10 224.     Prepro…\n 6    0.00000001            1 rsq     standard      0.539    10   0.0233 Prepro…\n 7    0.0000001             1 rmse    standard   6767.       10 224.     Prepro…\n 8    0.0000001             1 rsq     standard      0.539    10   0.0233 Prepro…\n 9    0.000001              1 rmse    standard   6767.       10 224.     Prepro…\n10    0.000001              1 rsq     standard      0.539    10   0.0233 Prepro…\n# ℹ 90 more rows\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\n# A tibble: 50 × 8\n   cost_complexity tree_depth .metric .estimator  mean     n std_err .config    \n             &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      \n 1    0.001                11 rmse    standard   3583.    10    204. Preprocess…\n 2    0.001                15 rmse    standard   3583.    10    204. Preprocess…\n 3    0.001                 8 rmse    standard   3597.    10    202. Preprocess…\n 4    0.0000000001         11 rmse    standard   3602.    10    202. Preprocess…\n 5    0.000000001          11 rmse    standard   3602.    10    202. Preprocess…\n 6    0.00000001           11 rmse    standard   3602.    10    202. Preprocess…\n 7    0.0000001            11 rmse    standard   3602.    10    202. Preprocess…\n 8    0.000001             11 rmse    standard   3602.    10    202. Preprocess…\n 9    0.00001              11 rmse    standard   3602.    10    202. Preprocess…\n10    0.0001               11 rmse    standard   3602.    10    202. Preprocess…\n# ℹ 40 more rows\n\n\n# A tibble: 1 × 3\n  cost_complexity tree_depth .config              \n            &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;                \n1           0.001         11 Preprocessor1_Model38\n\n\n# Resampling results\n# Manual resampling \n# A tibble: 1 × 6\n  splits           id               .metrics .notes   .predictions .workflow \n  &lt;list&gt;           &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    \n1 &lt;split [263/90]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;\n\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard    3281.    Preprocessor1_Model1\n2 rsq     standard       0.898 Preprocessor1_Model1\n\n\n══ Workflow [trained] ══════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: decision_tree()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n5 Recipe Steps\n\n• step_date()\n• step_mutate()\n• step_rm()\n• step_normalize()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nn= 263 \n\nnode), split, n, deviance, yval\n      * denotes terminal node\n\n  1) root 263 25536330000 17295.190  \n    2) avg_temp&lt; -0.2623656 109  2929334000  8638.789  \n      4) seasons_Winter&gt;=0.5 67   238111900  5474.194  \n        8) avg_temp&lt; -1.537823 21    24940570  4077.095 *\n        9) avg_temp&gt;=-1.537823 46   153469100  6112.000  \n         18) total_snowfall&gt;=1.085861 8    10038760  4350.250 *\n         19) total_snowfall&lt; 1.085861 38   113372800  6482.895 *\n      5) seasons_Winter&lt; 0.5 42   949863600 13687.070  \n       10) total_rainfall&gt;=-0.2571349 11   139349100  8418.273 *\n       11) total_rainfall&lt; -0.2571349 31   396797400 15556.650  \n         22) seasons_Spring&gt;=0.5 14    76964920 13076.500 *\n         23) seasons_Spring&lt; 0.5 17   162798000 17599.120 *\n    3) avg_temp&gt;=-0.2623656 154  8658212000 23422.120  \n      6) avg_solar_rad&lt; -1.012344 18   336145000  8131.056 *\n      7) avg_solar_rad&gt;=-1.012344 136  3556331000 25445.940  \n       14) total_rainfall&gt;=-0.1574262 21   389911600 20657.710  \n         28) weekend_weekend&gt;=0.5 8   105784700 18339.250 *\n         29) weekend_weekend&lt; 0.5 13   214661800 22084.460 *\n       15) total_rainfall&lt; -0.1574262 115  2597029000 26320.310  \n         30) avg_temp&lt; 0.3549168 34   574640800 23217.940  \n           60) avg_visibility&lt; -0.3624895 12   229010000 19939.330 *\n           61) avg_visibility&gt;=-0.3624895 22   146280700 25006.270  \n            122) avg_visibility&lt; 0.7457674 10    52168030 23576.900 *\n            123) avg_visibility&gt;=0.7457674 12    56655700 26197.420 *\n         31) avg_temp&gt;=0.3549168 81  1557788000 27622.540  \n           62) avg_temp&gt;=1.500792 14    72606990 21297.930 *\n           63) avg_temp&lt; 1.500792 67   808153800 28944.100  \n            126) avg_temp&lt; 0.5813303 12   150799500 25954.330 *\n            127) avg_temp&gt;=0.5813303 55   526686300 29596.420  \n              254) avg_dew_point&gt;=0.9189753 21    96862780 27196.810  \n                508) avg_temp&gt;=1.25526 11    27591330 26032.640 *\n                509) avg_temp&lt; 1.25526 10    37964040 28477.400 *\n              255) avg_dew_point&lt; 0.9189753 34   234216800 31078.530  \n                510) seasons_Summer&lt; 0.5 16    51196240 29933.380 *\n                511) seasons_Summer&gt;=0.5 18   143387700 32096.440 *\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# A tibble: 15 × 7\n   cost_complexity .metric .estimator  mean     n std_err .config              \n             &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                \n 1        3.73e- 8 rmse    standard   3187.    10    105. Preprocessor1_Model05\n 2        8.48e- 9 rmse    standard   3228.    10    132. Preprocessor1_Model04\n 3        1.64e- 7 rmse    standard   3237.    10    173. Preprocessor1_Model06\n 4        1   e-10 rmse    standard   3245.    10    120. Preprocessor1_Model01\n 5        4.39e-10 rmse    standard   3255.    10    164. Preprocessor1_Model02\n 6        5.18e- 3 rmse    standard   3260.    10    106. Preprocessor1_Model13\n 7        6.11e- 5 rmse    standard   3267.    10    148. Preprocessor1_Model10\n 8        1.39e- 5 rmse    standard   3278.    10    141. Preprocessor1_Model09\n 9        1.18e- 3 rmse    standard   3284.    10    144. Preprocessor1_Model12\n10        2.68e- 4 rmse    standard   3290.    10    144. Preprocessor1_Model11\n11        7.20e- 7 rmse    standard   3306.    10    139. Preprocessor1_Model07\n12        1.93e- 9 rmse    standard   3325.    10    132. Preprocessor1_Model03\n13        3.16e- 6 rmse    standard   3342.    10    115. Preprocessor1_Model08\n14        2.28e- 2 rmse    standard   3870.    10    158. Preprocessor1_Model14\n15        1   e- 1 rmse    standard   4772.    10    179. Preprocessor1_Model15\n\n\n\n\n\n\n\n\n\n# 1. Final fits for each model type\nmlr_final_fit &lt;- workflow_3 |&gt; \n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\nlasso_final_fit &lt;- lasso_wkf |&gt;\n  finalize_workflow(lasso_lowest_rmse) |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\ntree_final_fit &lt;- tree_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\nbag_final_fit &lt;- bag_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae, rsq))\n\nrf_final_fit &lt;- rf_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\n# 2. Create comparison dataframes\nfinal_metrics &lt;- tibble(\n    model = c(\"MLR\", \"LASSO\", \"Regression Tree\", \"Bagged Tree\", \"Random Forest\"),\n    rmse = c(\n        mlr_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        lasso_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        tree_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        bag_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        rf_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate)\n    )\n)\n\nfinal_mae &lt;- tibble(\n    model = c(\"MLR\", \"LASSO\", \"Regression Tree\", \"Bagged Tree\", \"Random Forest\"),\n    mae = c(\n        mlr_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        lasso_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        tree_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        bag_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        rf_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate)\n    )\n)\n\n# 3. Combine metrics\ncat(\"### RMSE by Model\")\n\n### RMSE by Model\n\nknitr::kable(final_metrics)\n\n\n\n\nmodel\nrmse\n\n\n\n\nMLR\n2912.733\n\n\nLASSO\n2992.677\n\n\nRegression Tree\n3280.566\n\n\nBagged Tree\n3071.612\n\n\nRandom Forest\n3162.745\n\n\n\n\ncat(\"### MAE by Model\")\n\n### MAE by Model\n\nknitr::kable(final_mae)\n\n\n\n\nmodel\nmae\n\n\n\n\nMLR\n2202.219\n\n\nLASSO\n2252.443\n\n\nRegression Tree\n2570.818\n\n\nBagged Tree\n2306.021\n\n\nRandom Forest\n2458.188\n\n\n\n\ncat(\"### Combined Performance Metrics\")\n\n### Combined Performance Metrics\n\nfinal_comparison &lt;- final_metrics %&gt;%\n  left_join(final_mae, by = \"model\")\nknitr::kable(final_comparison)\n\n\n\n\nmodel\nrmse\nmae\n\n\n\n\nMLR\n2912.733\n2202.219\n\n\nLASSO\n2992.677\n2252.443\n\n\nRegression Tree\n3280.566\n2570.818\n\n\nBagged Tree\n3071.612\n2306.021\n\n\nRandom Forest\n3162.745\n2458.188\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 1. Final coefficient tables for LASSO and MLR\nmlr_coef &lt;- mlr_final_fit |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy() |&gt;\n  knitr::kable()\n\nlasso_coef &lt;- lasso_final_fit |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()  |&gt;\n  knitr::kable()\n\n# 2. Plot regression tree\ntree_plot &lt;- tree_final_model |&gt;\n  extract_fit_engine() |&gt;\n  rpart.plot::rpart.plot(roundint = FALSE, main = \"Regression Tree Final Model\")\n\n\n\n\n\n\n\n# 3. Variable importance plots\n# For bagged trees\nbag_final_model &lt;- bag_final_fit |&gt;\n  extract_fit_parsnip()\n\nbag_importance &lt;- bag_final_model |&gt;\n  extract_fit_engine() |&gt;\n  var_imp() |&gt;\n  mutate(term = factor(term, levels = term)) |&gt;\n  ggplot(aes(x = term, y = value)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Bagged Trees Variable Importance\",\n       x = \"Variable\",\n       y = \"Importance\")\n# For random forest \nrf_final_model &lt;- rf_final_fit |&gt;\n  extract_fit_parsnip()\n\nrf_importance &lt;- vip(rf_final_model) +\n  labs(title = \"Random Forest Variable Importance\")\n\n# Display plots\nprint(bag_importance)\n\n\n\n\n\n\n\nprint(rf_importance)\n\n\n\n\n\n\n\n# 4. Show coefficients\nknitr::kable(mlr_coef)\n\n\n\n\n\n\n\nx\n\n\n\n\n|term | estimate| std.error| statistic| p.value|\n\n\n|:———————————–|———–:|———-:|———-:|———:|\n\n\n|(Intercept) | 15335.3689| 2200.0552| 6.9704472| 0.0000000|\n\n\n|total_snowfall | -151.8062| 214.7346| -0.7069479| 0.4802992|\n\n\n|seasons_Spring | -6644.8559| 3740.1388| -1.7766335| 0.0769222|\n\n\n|seasons_Summer | 17050.1876| 3548.3796| 4.8050630| 0.0000028|\n\n\n|seasons_Winter | -7253.3625| 3203.2863| -2.2643503| 0.0244646|\n\n\n|holiday_No.Holiday | 6229.8359| 2074.2386| 3.0034326| 0.0029583|\n\n\n|weekend_weekend | -2444.8625| 394.2574| -6.2011836| 0.0000000|\n\n\n|seasons_Spring_x_holiday_No.Holiday | 1842.6499| 3776.5935| 0.4879132| 0.6260662|\n\n\n|seasons_Summer_x_holiday_No.Holiday | -2830.4348| 2908.2642| -0.9732385| 0.3314355|\n\n\n|seasons_Winter_x_holiday_No.Holiday | -4336.4780| 2469.7232| -1.7558559| 0.0804158|\n\n\n|seasons_Spring_x_avg_temp | 4397.1401| 1124.3013| 3.9109979| 0.0001203|\n\n\n|seasons_Summer_x_avg_temp | -15356.3135| 2472.1846| -6.2116371| 0.0000000|\n\n\n|seasons_Winter_x_avg_temp | -6086.6639| 2900.7703| -2.0982922| 0.0369473|\n\n\n|avg_temp_x_total_rainfall | -1749.0581| 556.1764| -3.1447902| 0.0018763|\n\n\n|total_rainfall_poly_1 | -25797.7628| 7523.3458| -3.4290279| 0.0007152|\n\n\n|total_rainfall_poly_2 | 14798.4603| 3691.7113| 4.0085638| 0.0000821|\n\n\n|avg_temp_poly_1 | 16927.7764| 67404.7954| 0.2511361| 0.8019284|\n\n\n|avg_temp_poly_2 | -16154.9757| 17960.0403| -0.8994955| 0.3693096|\n\n\n|avg_humidity_poly_1 | -36206.2807| 24215.1386| -1.4951920| 0.1362060|\n\n\n|avg_humidity_poly_2 | 1731.2214| 5890.4178| 0.2939047| 0.7690902|\n\n\n|avg_wind_speed_poly_1 | -6616.5402| 3365.7457| -1.9658467| 0.0504938|\n\n\n|avg_wind_speed_poly_2 | 2028.9343| 3119.8204| 0.6503369| 0.5161099|\n\n\n|avg_visibility_poly_1 | 3619.3556| 4334.9943| 0.8349159| 0.4046130|\n\n\n|avg_visibility_poly_2 | -3202.9258| 3132.8409| -1.0223710| 0.3076566|\n\n\n|avg_dew_point_poly_1 | 102321.4322| 78833.3779| 1.2979456| 0.1955785|\n\n\n|avg_dew_point_poly_2 | -10803.8897| 11883.1233| -0.9091793| 0.3641870|\n\n\n|avg_solar_rad_poly_1 | 46642.6238| 5693.1932| 8.1926999| 0.0000000|\n\n\n|avg_solar_rad_poly_2 | -6750.6317| 3465.6005| -1.9478967| 0.0526181|\n\n\n\n\nknitr::kable(lasso_coef)\n\n\n\n\n\n\n\nx\n\n\n\n\n|term | estimate| penalty|\n\n\n|:———————————–|———–:|——-:|\n\n\n|(Intercept) | 15594.8809| 0|\n\n\n|total_rainfall | -1890.9485| 0|\n\n\n|total_snowfall | -173.7424| 0|\n\n\n|seasons_Spring | -7248.7856| 0|\n\n\n|seasons_Summer | 16954.3240| 0|\n\n\n|seasons_Winter | -6041.5374| 0|\n\n\n|holiday_No.Holiday | 6241.4365| 0|\n\n\n|weekend_weekend | -2482.2190| 0|\n\n\n|seasons_Spring_x_holiday_No.Holiday | 2278.0576| 0|\n\n\n|seasons_Summer_x_holiday_No.Holiday | -2712.4968| 0|\n\n\n|seasons_Winter_x_holiday_No.Holiday | -4252.8736| 0|\n\n\n|seasons_Spring_x_avg_temp | 4583.7036| 0|\n\n\n|seasons_Summer_x_avg_temp | -15810.1911| 0|\n\n\n|seasons_Winter_x_avg_temp | -4424.2041| 0|\n\n\n|avg_temp_x_total_rainfall | -746.0120| 0|\n\n\n|avg_temp_poly_1 | 31594.3834| 0|\n\n\n|avg_temp_poly_2 | -4183.5607| 0|\n\n\n|avg_humidity_poly_1 | -33948.6920| 0|\n\n\n|avg_humidity_poly_2 | 148.3535| 0|\n\n\n|avg_wind_speed_poly_1 | -7283.8236| 0|\n\n\n|avg_wind_speed_poly_2 | 1588.2248| 0|\n\n\n|avg_visibility_poly_1 | 2235.6367| 0|\n\n\n|avg_visibility_poly_2 | -2620.0411| 0|\n\n\n|avg_dew_point_poly_1 | 82027.0586| 0|\n\n\n|avg_dew_point_poly_2 | -15137.9168| 0|\n\n\n|avg_solar_rad_poly_1 | 51102.2624| 0|\n\n\n|avg_solar_rad_poly_2 | -8235.8516| 0|\n\n\n\n\n# 5. Fit best model to entire dataset\nbest_model &lt;- workflow_3 |&gt;\n  fit(bike_data)\n\nbest_model |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy() |&gt;\n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n16220.8198\n1566.8989\n10.3521804\n0.0000000\n\n\ntotal_snowfall\n-190.7570\n172.5941\n-1.1052349\n0.2698753\n\n\nseasons_Spring\n-1690.1899\n2238.5953\n-0.7550225\n0.4507822\n\n\nseasons_Summer\n17363.1798\n2967.4304\n5.8512508\n0.0000000\n\n\nseasons_Winter\n-7826.1966\n2435.1785\n-3.2138082\n0.0014413\n\n\nholiday_No.Holiday\n5544.5102\n1455.4134\n3.8095776\n0.0001664\n\n\nweekend_weekend\n-2419.7764\n334.2536\n-7.2393425\n0.0000000\n\n\nseasons_Spring_x_holiday_No.Holiday\n-2795.3406\n2274.2039\n-1.2291513\n0.2199043\n\n\nseasons_Summer_x_holiday_No.Holiday\n-1849.9401\n2460.1365\n-0.7519664\n0.4526155\n\n\nseasons_Winter_x_holiday_No.Holiday\n-3323.2703\n1794.2003\n-1.8522292\n0.0648995\n\n\nseasons_Spring_x_avg_temp\n5038.9305\n939.3334\n5.3643688\n0.0000002\n\n\nseasons_Summer_x_avg_temp\n-16036.3683\n1980.8304\n-8.0957807\n0.0000000\n\n\nseasons_Winter_x_avg_temp\n-4900.0809\n2412.3190\n-2.0312740\n0.0430406\n\n\navg_temp_x_total_rainfall\n-1496.8924\n433.2675\n-3.4548918\n0.0006235\n\n\ntotal_rainfall_poly_1\n-32417.5524\n6810.2605\n-4.7601046\n0.0000029\n\n\ntotal_rainfall_poly_2\n15954.5280\n3451.0152\n4.6231404\n0.0000055\n\n\navg_temp_poly_1\n54046.4000\n69464.3872\n0.7780447\n0.4371087\n\n\navg_temp_poly_2\n-18441.1978\n17021.2263\n-1.0834236\n0.2794236\n\n\navg_humidity_poly_1\n-22486.3905\n24440.7932\n-0.9200352\n0.3582367\n\n\navg_humidity_poly_2\n-7775.2097\n6074.8965\n-1.2798917\n0.2014961\n\n\navg_wind_speed_poly_1\n-8565.4180\n3298.3897\n-2.5968484\n0.0098360\n\n\navg_wind_speed_poly_2\n3234.9063\n3033.6292\n1.0663486\n0.2870576\n\n\navg_visibility_poly_1\n4907.7547\n4295.9116\n1.1424245\n0.2541185\n\n\navg_visibility_poly_2\n-507.1624\n3023.9973\n-0.1677126\n0.8669137\n\n\navg_dew_point_poly_1\n62228.7543\n81037.9071\n0.7678969\n0.4431060\n\n\navg_dew_point_poly_2\n-2609.8231\n11488.1486\n-0.2271753\n0.8204303\n\n\navg_solar_rad_poly_1\n54111.2921\n5653.8611\n9.5706794\n0.0000000\n\n\navg_solar_rad_poly_2\n-6582.7551\n3485.6564\n-1.8885267\n0.0598456"
  },
  {
    "objectID": "hw9.html#basic-eda",
    "href": "hw9.html#basic-eda",
    "title": "Homework 9",
    "section": "",
    "text": "#Basic EDA\n#Missing values\nmissing_summ &lt;- soul_bikes |&gt;\n  summarize(across(everything(), \\(x) sum(is.na(x)))) |&gt;\n  pivot_longer(everything(),\n                names_to = \"variable\",\n                values_to = \"missing_count\")\nmissing_summ\n\n# A tibble: 14 × 2\n   variable                  missing_count\n   &lt;chr&gt;                             &lt;int&gt;\n 1 Date                                  0\n 2 Rented Bike Count                     0\n 3 Hour                                  0\n 4 Temperature(°C)                       0\n 5 Humidity(%)                           0\n 6 Wind speed (m/s)                      0\n 7 Visibility (10m)                      0\n 8 Dew point temperature(°C)             0\n 9 Solar Radiation (MJ/m2)               0\n10 Rainfall(mm)                          0\n11 Snowfall (cm)                         0\n12 Seasons                               0\n13 Holiday                               0\n14 Functioning Day                       0\n\n#By variable summary stats for numerics\nbike_summ_nums &lt;- soul_bikes_functioning |&gt;\n  select(where(is.numeric)) |&gt;\n  summarize(across(everything(),\n                   list(\n                     mean = \\(x) mean(x, na.rm = TRUE),\n                     sd = \\(x) sd(x, na.rm = TRUE),\n                     median = \\(x) median(x, na.rm = TRUE),\n                     iqr = \\(x) IQR(x, na.rm = TRUE),\n                     min = \\(x) min(x, na.rm = TRUE),\n                     max = \\(x) max(x, na.rm = TRUE),\n                     n_missing = \\(x) sum(is.na(x))\n                   ))) |&gt;\n              pivot_longer(\n                everything(),\n                names_to = c(\"column\", \"stat\"),\n                names_pattern = \"(.*)_(.*)\",\n                values_to = \"values\"\n              )\n\n#By variable summary stats for character/factor\nbike_summ_cats &lt;- soul_bikes_functioning |&gt;\n  select(where(is.character), where(is.factor)) |&gt;\n  summarize(across(everything(),\n    list(\n      n_unique = \\(x) n_distinct(x),\n      n_missing = \\(x) sum(is.na(x))\n    )\n  )) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = c(\"column\", \"stat\"),\n    names_pattern = \"(.*)_(.*)\",\n    values_to = \"value\"\n  )\n\n# Factor levels summary\nfactor_levels &lt;- soul_bikes_functioning |&gt;\n  select(where(is.factor), where(is.character)) |&gt;\n  summarize(across(everything(), \\(x) list(sort(unique(x))))) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = \"column\",\n    values_to = \"levels\"\n  ) |&gt;\n  mutate(\n    n_levels = map_int(levels, length),\n    levels = map_chr(levels, toString)\n  )\n\n#7. Summarize across hours\ndaily_summ &lt;- soul_bikes_functioning |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(\n    #totals\n    total_bikes = sum(rented_bike_count),\n    total_rainfall = sum(rainfall_mm),\n    total_snowfall = sum(snowfall_cm),\n\n    #weather means\n    avg_temp = mean(temperature_c),\n    avg_humidity = mean(humidity_percent),\n    avg_wind_speed = mean(wind_speed_m_s),\n    avg_visibility = mean(visibility_10m),\n    avg_dew_point = mean(dew_point_temperature_c),\n    avg_solar_rad = mean(solar_radiation_mj_m2),\n    .groups = \"drop\"  # Drop grouping after summary\n  )\ndaily_summ\n\n# A tibble: 353 × 12\n   date       seasons holiday total_bikes total_rainfall total_snowfall avg_temp\n   &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;         &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;\n 1 2017-12-01 Winter  No Hol…        9539            0              0    -2.45  \n 2 2017-12-02 Winter  No Hol…        8523            0              0     1.32  \n 3 2017-12-03 Winter  No Hol…        7222            4              0     4.88  \n 4 2017-12-04 Winter  No Hol…        8729            0.1            0    -0.304 \n 5 2017-12-05 Winter  No Hol…        8307            0              0    -4.46  \n 6 2017-12-06 Winter  No Hol…        6669            1.3            8.6   0.0458\n 7 2017-12-07 Winter  No Hol…        8549            0             10.4   1.09  \n 8 2017-12-08 Winter  No Hol…        8032            0              0    -3.82  \n 9 2017-12-09 Winter  No Hol…        7233            0              0    -0.846 \n10 2017-12-10 Winter  No Hol…        3453            4.1           32.5   1.19  \n# ℹ 343 more rows\n# ℹ 5 more variables: avg_humidity &lt;dbl&gt;, avg_wind_speed &lt;dbl&gt;,\n#   avg_visibility &lt;dbl&gt;, avg_dew_point &lt;dbl&gt;, avg_solar_rad &lt;dbl&gt;\n\n#Summaries of numerics\nbike_summ_nums &lt;- daily_summ |&gt;\n  select(where(is.numeric)) |&gt;\n  summarize(across(everything(),\n                   list(\n                     mean = \\(x) mean(x, na.rm = TRUE),\n                     sd = \\(x) sd(x, na.rm = TRUE),\n                     median = \\(x) median(x, na.rm = TRUE),\n                     iqr = \\(x) IQR(x, na.rm = TRUE),\n                     min = \\(x) min(x, na.rm = TRUE),\n                     max = \\(x) max(x, na.rm = TRUE),\n                     n_missing = \\(x) sum(is.na(x))\n                   ))) |&gt;\n  pivot_longer(\n    everything(),\n    names_to = c(\"column\", \"stat\"),\n    names_pattern = \"(.*)_(.*)\",\n    values_to = \"values\"\n  )\nbike_summ_nums\n\n# A tibble: 63 × 3\n   column         stat      values\n   &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;\n 1 total_bikes    mean    17485.  \n 2 total_bikes    sd       9937.  \n 3 total_bikes    median  18563   \n 4 total_bikes    iqr     19318   \n 5 total_bikes    min       977   \n 6 total_bikes    max     36149   \n 7 total_bikes_n  missing     0   \n 8 total_rainfall mean        3.58\n 9 total_rainfall sd         11.8 \n10 total_rainfall median      0   \n# ℹ 53 more rows"
  },
  {
    "objectID": "hw9.html#plots",
    "href": "hw9.html#plots",
    "title": "Homework 9",
    "section": "",
    "text": "# Calculate correlation matrix\ncor_matrix &lt;- daily_summ |&gt;\n  select(total_bikes, avg_temp, avg_humidity, avg_wind_speed,\n         avg_visibility, avg_solar_rad, total_rainfall, total_snowfall) |&gt;\n  cor(use = \"complete.obs\")\ncor_matrix\n\n               total_bikes     avg_temp avg_humidity avg_wind_speed\ntotal_bikes     1.00000000  0.753076732   0.03588697    -0.19288142\navg_temp        0.75307673  1.000000000   0.40416749    -0.26072179\navg_humidity    0.03588697  0.404167486   1.00000000    -0.23425778\navg_wind_speed -0.19288142 -0.260721792  -0.23425778     1.00000000\navg_visibility  0.16599375  0.002336683  -0.55917733     0.20602264\navg_solar_rad   0.73589290  0.550274301  -0.27444967     0.09612635\ntotal_rainfall -0.23910905  0.144517274   0.52864263    -0.10167578\ntotal_snowfall -0.26529110 -0.266963662   0.06539191     0.02088156\n               avg_visibility avg_solar_rad total_rainfall total_snowfall\ntotal_bikes       0.165993749    0.73589290    -0.23910905    -0.26529110\navg_temp          0.002336683    0.55027430     0.14451727    -0.26696366\navg_humidity     -0.559177334   -0.27444967     0.52864263     0.06539191\navg_wind_speed    0.206022636    0.09612635    -0.10167578     0.02088156\navg_visibility    1.000000000    0.27139591    -0.22199387    -0.10188902\navg_solar_rad     0.271395906    1.00000000    -0.32270413    -0.23343056\ntotal_rainfall   -0.221993866   -0.32270413     1.00000000    -0.02313404\ntotal_snowfall   -0.101889019   -0.23343056    -0.02313404     1.00000000\n\n# Create correlation plot\ncorrplot(cor_matrix,\n         method = \"color\",\n         type = \"upper\",\n         addCoef.col = \"black\",\n         tl.col = \"black\",\n         tl.srt = 45,\n         diag = FALSE)\n\n\n\n\n\n\n\n# Individual scatter plots with trend lines\ntemp_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_temp, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"red\") +\n  labs(title = \"Temperature vs Bike Rentals\",\n       x = \"Average Temperature (°C)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nhumid_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_humidity, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"blue\") +\n  labs(title = \"Humidity vs Bike Rentals\",\n       x = \"Average Humidity (%)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nsun_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_solar_rad, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"orange\") +\n  labs(title = \"Solar Radiation vs Bike Rentals\",\n       x = \"Average Solar Radiation (MJ/m2)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\nvis_v_rentals &lt;- ggplot(daily_summ, aes(x = avg_visibility, y = total_bikes)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"loess\", color = \"green4\") +\n  labs(title = \"Visibility vs Bike Rentals\",\n       x = \"Average Visibility (10m)\",\n       y = \"Total Daily Rentals\") +\n  theme_minimal()\n\n# Arrange plots in a grid\n\ngrid.arrange(temp_v_rentals, humid_v_rentals, sun_v_rentals, vis_v_rentals, ncol = 2)\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "hw9.html#mlr",
    "href": "hw9.html#mlr",
    "title": "Homework 9",
    "section": "",
    "text": "Rows: 263\nColumns: 15\n$ date               &lt;date&gt; 2018-09-05, 2018-09-06, 2018-09-07, 2018-09-08, 20…\n$ total_rainfall     &lt;dbl&gt; -0.2970185, -0.2970185, -0.1773679, -0.2970185, -0.…\n$ total_snowfall     &lt;dbl&gt; -0.2179228, -0.2179228, -0.2179228, -0.2179228, -0.…\n$ avg_temp           &lt;dbl&gt; 0.942813132, 0.977863864, 0.800131869, 0.760478516,…\n$ avg_humidity       &lt;dbl&gt; 0.21420205, 0.81794255, -0.11561916, -0.66625286, -…\n$ avg_wind_speed     &lt;dbl&gt; 1.32331031, 0.28870706, 1.28079237, -0.10104074, -0…\n$ avg_visibility     &lt;dbl&gt; 1.05187245, 0.41451440, 0.84111295, 1.10774745, 1.1…\n$ avg_dew_point      &lt;dbl&gt; 0.87630133, 1.09270791, 0.66181269, 0.44380783, 0.4…\n$ avg_solar_rad      &lt;dbl&gt; 1.17578189, -0.32588618, 0.79740883, 1.21388195, 1.…\n$ total_bikes        &lt;dbl&gt; 31114, 27838, 30381, 29813, 28354, 30781, 31809, 30…\n$ seasons_Spring     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ seasons_Summer     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ seasons_Winter     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ holiday_No.Holiday &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, …\n$ weekend_weekend    &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, …\n\n\nRows: 263\nColumns: 25\n$ date                                           &lt;date&gt; 2018-09-05, 2018-09-06…\n$ total_rainfall                                 &lt;dbl&gt; -0.2970185, -0.2970185,…\n$ total_snowfall                                 &lt;dbl&gt; -0.2179228, -0.2179228,…\n$ avg_temp                                       &lt;dbl&gt; 0.942813132, 0.97786386…\n$ avg_humidity                                   &lt;dbl&gt; 0.21420205, 0.81794255,…\n$ avg_wind_speed                                 &lt;dbl&gt; 1.32331031, 0.28870706,…\n$ avg_visibility                                 &lt;dbl&gt; 1.05187245, 0.41451440,…\n$ avg_dew_point                                  &lt;dbl&gt; 0.87630133, 1.09270791,…\n$ avg_solar_rad                                  &lt;dbl&gt; 1.17578189, -0.32588618…\n$ total_bikes                                    &lt;dbl&gt; 31114, 27838, 30381, 29…\n$ seasons_Spring                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ holiday_No.Holiday                             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1,…\n$ weekend_weekend                                &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0,…\n$ seasons_Spring_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_holiday_No.Holiday            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Spring_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_avg_temp                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Spring_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Summer_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ seasons_Winter_x_holiday_No.Holiday_x_avg_temp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0,…\n$ total_rainfall_x_avg_temp                      &lt;dbl&gt; -0.280032902, -0.290443…\n\n\nRows: 263\nColumns: 29\n$ date                                &lt;date&gt; 2018-09-05, 2018-09-06, 2018-09-0…\n$ total_snowfall                      &lt;dbl&gt; -0.2179228, -0.2179228, -0.2179228…\n$ total_bikes                         &lt;dbl&gt; 31114, 27838, 30381, 29813, 28354,…\n$ seasons_Spring                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ holiday_No.Holiday                  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ weekend_weekend                     &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0…\n$ seasons_Spring_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter_x_holiday_No.Holiday &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Spring_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Summer_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons_Winter_x_avg_temp           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ avg_temp_x_total_rainfall           &lt;dbl&gt; -0.280032902, -0.290443616, -0.141…\n$ total_rainfall_poly_1               &lt;dbl&gt; -0.018349862, -0.018349862, -0.010…\n$ total_rainfall_poly_2               &lt;dbl&gt; 0.017787545, 0.017787545, -0.00247…\n$ avg_temp_poly_1                     &lt;dbl&gt; 0.0582471898, 0.0604126312, 0.0494…\n$ avg_temp_poly_2                     &lt;dbl&gt; 4.343638e-03, 8.936806e-03, -1.277…\n$ avg_humidity_poly_1                 &lt;dbl&gt; 0.013233447, 0.050532660, -0.00714…\n$ avg_humidity_poly_2                 &lt;dbl&gt; -0.049710700, -0.025703529, -0.047…\n$ avg_wind_speed_poly_1               &lt;dbl&gt; 0.081754384, 0.017836382, 0.079127…\n$ avg_wind_speed_poly_2               &lt;dbl&gt; -0.022889314, -0.051814842, -0.025…\n$ avg_visibility_poly_1               &lt;dbl&gt; 0.064984897, 0.025608785, 0.051964…\n$ avg_visibility_poly_2               &lt;dbl&gt; 0.052485925, -0.039054487, 0.01602…\n$ avg_dew_point_poly_1                &lt;dbl&gt; 0.054138077, 0.067507720, 0.040886…\n$ avg_dew_point_poly_2                &lt;dbl&gt; 0.0010118908, 0.0310969311, -0.023…\n$ avg_solar_rad_poly_1                &lt;dbl&gt; 0.072640048, -0.020133316, 0.04926…\n$ avg_solar_rad_poly_2                &lt;dbl&gt; 0.008080770, -0.053656723, -0.0353…\n\n\n# A tibble: 3 × 7\n  .metric .estimator  mean     n std_err .config              model  \n  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;  \n1 rmse    standard   2946.    10    236. Preprocessor1_Model1 Model 3\n2 rmse    standard   3460.    10    475. Preprocessor1_Model1 Model 2\n3 rmse    standard   4151.    10    150. Preprocessor1_Model1 Model 1\n\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard    2913.    Preprocessor1_Model1\n2 rsq     standard       0.919 Preprocessor1_Model1\n\n\n# A tibble: 28 × 5\n   term                                estimate std.error statistic  p.value\n   &lt;chr&gt;                                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                           15335.     2200.     6.97  3.17e-11\n 2 total_snowfall                         -152.      215.    -0.707 4.80e- 1\n 3 seasons_Spring                        -6645.     3740.    -1.78  7.69e- 2\n 4 seasons_Summer                        17050.     3548.     4.81  2.76e- 6\n 5 seasons_Winter                        -7253.     3203.    -2.26  2.45e- 2\n 6 holiday_No.Holiday                     6230.     2074.     3.00  2.96e- 3\n 7 weekend_weekend                       -2445.      394.    -6.20  2.50e- 9\n 8 seasons_Spring_x_holiday_No.Holiday    1843.     3777.     0.488 6.26e- 1\n 9 seasons_Summer_x_holiday_No.Holiday   -2830.     2908.    -0.973 3.31e- 1\n10 seasons_Winter_x_holiday_No.Holiday   -4336.     2470.    -1.76  8.04e- 2\n# ℹ 18 more rows"
  },
  {
    "objectID": "hw9.html#lasso-model",
    "href": "hw9.html#lasso-model",
    "title": "Homework 9",
    "section": "",
    "text": "# A tibble: 27 × 3\n   term                                estimate      penalty\n   &lt;chr&gt;                                  &lt;dbl&gt;        &lt;dbl&gt;\n 1 (Intercept)                           15595. 0.0000000001\n 2 total_rainfall                        -1891. 0.0000000001\n 3 total_snowfall                         -174. 0.0000000001\n 4 seasons_Spring                        -7249. 0.0000000001\n 5 seasons_Summer                        16954. 0.0000000001\n 6 seasons_Winter                        -6042. 0.0000000001\n 7 holiday_No.Holiday                     6241. 0.0000000001\n 8 weekend_weekend                       -2482. 0.0000000001\n 9 seasons_Spring_x_holiday_No.Holiday    2278. 0.0000000001\n10 seasons_Summer_x_holiday_No.Holiday   -2712. 0.0000000001\n# ℹ 17 more rows"
  },
  {
    "objectID": "hw9.html#regression-tree",
    "href": "hw9.html#regression-tree",
    "title": "Homework 9",
    "section": "",
    "text": "# A tibble: 100 × 8\n   cost_complexity tree_depth .metric .estimator     mean     n  std_err .config\n             &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;  \n 1    0.0000000001          1 rmse    standard   6767.       10 224.     Prepro…\n 2    0.0000000001          1 rsq     standard      0.539    10   0.0233 Prepro…\n 3    0.000000001           1 rmse    standard   6767.       10 224.     Prepro…\n 4    0.000000001           1 rsq     standard      0.539    10   0.0233 Prepro…\n 5    0.00000001            1 rmse    standard   6767.       10 224.     Prepro…\n 6    0.00000001            1 rsq     standard      0.539    10   0.0233 Prepro…\n 7    0.0000001             1 rmse    standard   6767.       10 224.     Prepro…\n 8    0.0000001             1 rsq     standard      0.539    10   0.0233 Prepro…\n 9    0.000001              1 rmse    standard   6767.       10 224.     Prepro…\n10    0.000001              1 rsq     standard      0.539    10   0.0233 Prepro…\n# ℹ 90 more rows\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\n# A tibble: 50 × 8\n   cost_complexity tree_depth .metric .estimator  mean     n std_err .config    \n             &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      \n 1    0.001                11 rmse    standard   3583.    10    204. Preprocess…\n 2    0.001                15 rmse    standard   3583.    10    204. Preprocess…\n 3    0.001                 8 rmse    standard   3597.    10    202. Preprocess…\n 4    0.0000000001         11 rmse    standard   3602.    10    202. Preprocess…\n 5    0.000000001          11 rmse    standard   3602.    10    202. Preprocess…\n 6    0.00000001           11 rmse    standard   3602.    10    202. Preprocess…\n 7    0.0000001            11 rmse    standard   3602.    10    202. Preprocess…\n 8    0.000001             11 rmse    standard   3602.    10    202. Preprocess…\n 9    0.00001              11 rmse    standard   3602.    10    202. Preprocess…\n10    0.0001               11 rmse    standard   3602.    10    202. Preprocess…\n# ℹ 40 more rows\n\n\n# A tibble: 1 × 3\n  cost_complexity tree_depth .config              \n            &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;                \n1           0.001         11 Preprocessor1_Model38\n\n\n# Resampling results\n# Manual resampling \n# A tibble: 1 × 6\n  splits           id               .metrics .notes   .predictions .workflow \n  &lt;list&gt;           &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    \n1 &lt;split [263/90]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;\n\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard    3281.    Preprocessor1_Model1\n2 rsq     standard       0.898 Preprocessor1_Model1\n\n\n══ Workflow [trained] ══════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: decision_tree()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n5 Recipe Steps\n\n• step_date()\n• step_mutate()\n• step_rm()\n• step_normalize()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nn= 263 \n\nnode), split, n, deviance, yval\n      * denotes terminal node\n\n  1) root 263 25536330000 17295.190  \n    2) avg_temp&lt; -0.2623656 109  2929334000  8638.789  \n      4) seasons_Winter&gt;=0.5 67   238111900  5474.194  \n        8) avg_temp&lt; -1.537823 21    24940570  4077.095 *\n        9) avg_temp&gt;=-1.537823 46   153469100  6112.000  \n         18) total_snowfall&gt;=1.085861 8    10038760  4350.250 *\n         19) total_snowfall&lt; 1.085861 38   113372800  6482.895 *\n      5) seasons_Winter&lt; 0.5 42   949863600 13687.070  \n       10) total_rainfall&gt;=-0.2571349 11   139349100  8418.273 *\n       11) total_rainfall&lt; -0.2571349 31   396797400 15556.650  \n         22) seasons_Spring&gt;=0.5 14    76964920 13076.500 *\n         23) seasons_Spring&lt; 0.5 17   162798000 17599.120 *\n    3) avg_temp&gt;=-0.2623656 154  8658212000 23422.120  \n      6) avg_solar_rad&lt; -1.012344 18   336145000  8131.056 *\n      7) avg_solar_rad&gt;=-1.012344 136  3556331000 25445.940  \n       14) total_rainfall&gt;=-0.1574262 21   389911600 20657.710  \n         28) weekend_weekend&gt;=0.5 8   105784700 18339.250 *\n         29) weekend_weekend&lt; 0.5 13   214661800 22084.460 *\n       15) total_rainfall&lt; -0.1574262 115  2597029000 26320.310  \n         30) avg_temp&lt; 0.3549168 34   574640800 23217.940  \n           60) avg_visibility&lt; -0.3624895 12   229010000 19939.330 *\n           61) avg_visibility&gt;=-0.3624895 22   146280700 25006.270  \n            122) avg_visibility&lt; 0.7457674 10    52168030 23576.900 *\n            123) avg_visibility&gt;=0.7457674 12    56655700 26197.420 *\n         31) avg_temp&gt;=0.3549168 81  1557788000 27622.540  \n           62) avg_temp&gt;=1.500792 14    72606990 21297.930 *\n           63) avg_temp&lt; 1.500792 67   808153800 28944.100  \n            126) avg_temp&lt; 0.5813303 12   150799500 25954.330 *\n            127) avg_temp&gt;=0.5813303 55   526686300 29596.420  \n              254) avg_dew_point&gt;=0.9189753 21    96862780 27196.810  \n                508) avg_temp&gt;=1.25526 11    27591330 26032.640 *\n                509) avg_temp&lt; 1.25526 10    37964040 28477.400 *\n              255) avg_dew_point&lt; 0.9189753 34   234216800 31078.530  \n                510) seasons_Summer&lt; 0.5 16    51196240 29933.380 *\n                511) seasons_Summer&gt;=0.5 18   143387700 32096.440 *"
  },
  {
    "objectID": "hw9.html#bagged-tree",
    "href": "hw9.html#bagged-tree",
    "title": "Homework 9",
    "section": "",
    "text": "# A tibble: 15 × 7\n   cost_complexity .metric .estimator  mean     n std_err .config              \n             &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                \n 1        3.73e- 8 rmse    standard   3187.    10    105. Preprocessor1_Model05\n 2        8.48e- 9 rmse    standard   3228.    10    132. Preprocessor1_Model04\n 3        1.64e- 7 rmse    standard   3237.    10    173. Preprocessor1_Model06\n 4        1   e-10 rmse    standard   3245.    10    120. Preprocessor1_Model01\n 5        4.39e-10 rmse    standard   3255.    10    164. Preprocessor1_Model02\n 6        5.18e- 3 rmse    standard   3260.    10    106. Preprocessor1_Model13\n 7        6.11e- 5 rmse    standard   3267.    10    148. Preprocessor1_Model10\n 8        1.39e- 5 rmse    standard   3278.    10    141. Preprocessor1_Model09\n 9        1.18e- 3 rmse    standard   3284.    10    144. Preprocessor1_Model12\n10        2.68e- 4 rmse    standard   3290.    10    144. Preprocessor1_Model11\n11        7.20e- 7 rmse    standard   3306.    10    139. Preprocessor1_Model07\n12        1.93e- 9 rmse    standard   3325.    10    132. Preprocessor1_Model03\n13        3.16e- 6 rmse    standard   3342.    10    115. Preprocessor1_Model08\n14        2.28e- 2 rmse    standard   3870.    10    158. Preprocessor1_Model14\n15        1   e- 1 rmse    standard   4772.    10    179. Preprocessor1_Model15"
  },
  {
    "objectID": "hw9.html#compare-models",
    "href": "hw9.html#compare-models",
    "title": "Homework 9",
    "section": "",
    "text": "# 1. Final fits for each model type\nmlr_final_fit &lt;- workflow_3 |&gt; \n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\nlasso_final_fit &lt;- lasso_wkf |&gt;\n  finalize_workflow(lasso_lowest_rmse) |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\ntree_final_fit &lt;- tree_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\nbag_final_fit &lt;- bag_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae, rsq))\n\nrf_final_fit &lt;- rf_final_wkf |&gt;\n  last_fit(bike_split, metrics = metric_set(rmse, mae))\n\n# 2. Create comparison dataframes\nfinal_metrics &lt;- tibble(\n    model = c(\"MLR\", \"LASSO\", \"Regression Tree\", \"Bagged Tree\", \"Random Forest\"),\n    rmse = c(\n        mlr_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        lasso_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        tree_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        bag_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate),\n        rf_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\") |&gt; pull(.estimate)\n    )\n)\n\nfinal_mae &lt;- tibble(\n    model = c(\"MLR\", \"LASSO\", \"Regression Tree\", \"Bagged Tree\", \"Random Forest\"),\n    mae = c(\n        mlr_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        lasso_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        tree_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        bag_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate),\n        rf_final_fit |&gt; collect_metrics() |&gt; filter(.metric == \"mae\") |&gt; pull(.estimate)\n    )\n)\n\n# 3. Combine metrics\ncat(\"### RMSE by Model\")\n\n### RMSE by Model\n\nknitr::kable(final_metrics)\n\n\n\n\nmodel\nrmse\n\n\n\n\nMLR\n2912.733\n\n\nLASSO\n2992.677\n\n\nRegression Tree\n3280.566\n\n\nBagged Tree\n3071.612\n\n\nRandom Forest\n3162.745\n\n\n\n\ncat(\"### MAE by Model\")\n\n### MAE by Model\n\nknitr::kable(final_mae)\n\n\n\n\nmodel\nmae\n\n\n\n\nMLR\n2202.219\n\n\nLASSO\n2252.443\n\n\nRegression Tree\n2570.818\n\n\nBagged Tree\n2306.021\n\n\nRandom Forest\n2458.188\n\n\n\n\ncat(\"### Combined Performance Metrics\")\n\n### Combined Performance Metrics\n\nfinal_comparison &lt;- final_metrics %&gt;%\n  left_join(final_mae, by = \"model\")\nknitr::kable(final_comparison)\n\n\n\n\nmodel\nrmse\nmae\n\n\n\n\nMLR\n2912.733\n2202.219\n\n\nLASSO\n2992.677\n2252.443\n\n\nRegression Tree\n3280.566\n2570.818\n\n\nBagged Tree\n3071.612\n2306.021\n\n\nRandom Forest\n3162.745\n2458.188"
  },
  {
    "objectID": "hw9.html#summarize-models",
    "href": "hw9.html#summarize-models",
    "title": "Homework 9",
    "section": "",
    "text": "# 1. Final coefficient tables for LASSO and MLR\nmlr_coef &lt;- mlr_final_fit |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy() |&gt;\n  knitr::kable()\n\nlasso_coef &lt;- lasso_final_fit |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()  |&gt;\n  knitr::kable()\n\n# 2. Plot regression tree\ntree_plot &lt;- tree_final_model |&gt;\n  extract_fit_engine() |&gt;\n  rpart.plot::rpart.plot(roundint = FALSE, main = \"Regression Tree Final Model\")\n\n\n\n\n\n\n\n# 3. Variable importance plots\n# For bagged trees\nbag_final_model &lt;- bag_final_fit |&gt;\n  extract_fit_parsnip()\n\nbag_importance &lt;- bag_final_model |&gt;\n  extract_fit_engine() |&gt;\n  var_imp() |&gt;\n  mutate(term = factor(term, levels = term)) |&gt;\n  ggplot(aes(x = term, y = value)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Bagged Trees Variable Importance\",\n       x = \"Variable\",\n       y = \"Importance\")\n# For random forest \nrf_final_model &lt;- rf_final_fit |&gt;\n  extract_fit_parsnip()\n\nrf_importance &lt;- vip(rf_final_model) +\n  labs(title = \"Random Forest Variable Importance\")\n\n# Display plots\nprint(bag_importance)\n\n\n\n\n\n\n\nprint(rf_importance)\n\n\n\n\n\n\n\n# 4. Show coefficients\nknitr::kable(mlr_coef)\n\n\n\n\n\n\n\nx\n\n\n\n\n|term | estimate| std.error| statistic| p.value|\n\n\n|:———————————–|———–:|———-:|———-:|———:|\n\n\n|(Intercept) | 15335.3689| 2200.0552| 6.9704472| 0.0000000|\n\n\n|total_snowfall | -151.8062| 214.7346| -0.7069479| 0.4802992|\n\n\n|seasons_Spring | -6644.8559| 3740.1388| -1.7766335| 0.0769222|\n\n\n|seasons_Summer | 17050.1876| 3548.3796| 4.8050630| 0.0000028|\n\n\n|seasons_Winter | -7253.3625| 3203.2863| -2.2643503| 0.0244646|\n\n\n|holiday_No.Holiday | 6229.8359| 2074.2386| 3.0034326| 0.0029583|\n\n\n|weekend_weekend | -2444.8625| 394.2574| -6.2011836| 0.0000000|\n\n\n|seasons_Spring_x_holiday_No.Holiday | 1842.6499| 3776.5935| 0.4879132| 0.6260662|\n\n\n|seasons_Summer_x_holiday_No.Holiday | -2830.4348| 2908.2642| -0.9732385| 0.3314355|\n\n\n|seasons_Winter_x_holiday_No.Holiday | -4336.4780| 2469.7232| -1.7558559| 0.0804158|\n\n\n|seasons_Spring_x_avg_temp | 4397.1401| 1124.3013| 3.9109979| 0.0001203|\n\n\n|seasons_Summer_x_avg_temp | -15356.3135| 2472.1846| -6.2116371| 0.0000000|\n\n\n|seasons_Winter_x_avg_temp | -6086.6639| 2900.7703| -2.0982922| 0.0369473|\n\n\n|avg_temp_x_total_rainfall | -1749.0581| 556.1764| -3.1447902| 0.0018763|\n\n\n|total_rainfall_poly_1 | -25797.7628| 7523.3458| -3.4290279| 0.0007152|\n\n\n|total_rainfall_poly_2 | 14798.4603| 3691.7113| 4.0085638| 0.0000821|\n\n\n|avg_temp_poly_1 | 16927.7764| 67404.7954| 0.2511361| 0.8019284|\n\n\n|avg_temp_poly_2 | -16154.9757| 17960.0403| -0.8994955| 0.3693096|\n\n\n|avg_humidity_poly_1 | -36206.2807| 24215.1386| -1.4951920| 0.1362060|\n\n\n|avg_humidity_poly_2 | 1731.2214| 5890.4178| 0.2939047| 0.7690902|\n\n\n|avg_wind_speed_poly_1 | -6616.5402| 3365.7457| -1.9658467| 0.0504938|\n\n\n|avg_wind_speed_poly_2 | 2028.9343| 3119.8204| 0.6503369| 0.5161099|\n\n\n|avg_visibility_poly_1 | 3619.3556| 4334.9943| 0.8349159| 0.4046130|\n\n\n|avg_visibility_poly_2 | -3202.9258| 3132.8409| -1.0223710| 0.3076566|\n\n\n|avg_dew_point_poly_1 | 102321.4322| 78833.3779| 1.2979456| 0.1955785|\n\n\n|avg_dew_point_poly_2 | -10803.8897| 11883.1233| -0.9091793| 0.3641870|\n\n\n|avg_solar_rad_poly_1 | 46642.6238| 5693.1932| 8.1926999| 0.0000000|\n\n\n|avg_solar_rad_poly_2 | -6750.6317| 3465.6005| -1.9478967| 0.0526181|\n\n\n\n\nknitr::kable(lasso_coef)\n\n\n\n\n\n\n\nx\n\n\n\n\n|term | estimate| penalty|\n\n\n|:———————————–|———–:|——-:|\n\n\n|(Intercept) | 15594.8809| 0|\n\n\n|total_rainfall | -1890.9485| 0|\n\n\n|total_snowfall | -173.7424| 0|\n\n\n|seasons_Spring | -7248.7856| 0|\n\n\n|seasons_Summer | 16954.3240| 0|\n\n\n|seasons_Winter | -6041.5374| 0|\n\n\n|holiday_No.Holiday | 6241.4365| 0|\n\n\n|weekend_weekend | -2482.2190| 0|\n\n\n|seasons_Spring_x_holiday_No.Holiday | 2278.0576| 0|\n\n\n|seasons_Summer_x_holiday_No.Holiday | -2712.4968| 0|\n\n\n|seasons_Winter_x_holiday_No.Holiday | -4252.8736| 0|\n\n\n|seasons_Spring_x_avg_temp | 4583.7036| 0|\n\n\n|seasons_Summer_x_avg_temp | -15810.1911| 0|\n\n\n|seasons_Winter_x_avg_temp | -4424.2041| 0|\n\n\n|avg_temp_x_total_rainfall | -746.0120| 0|\n\n\n|avg_temp_poly_1 | 31594.3834| 0|\n\n\n|avg_temp_poly_2 | -4183.5607| 0|\n\n\n|avg_humidity_poly_1 | -33948.6920| 0|\n\n\n|avg_humidity_poly_2 | 148.3535| 0|\n\n\n|avg_wind_speed_poly_1 | -7283.8236| 0|\n\n\n|avg_wind_speed_poly_2 | 1588.2248| 0|\n\n\n|avg_visibility_poly_1 | 2235.6367| 0|\n\n\n|avg_visibility_poly_2 | -2620.0411| 0|\n\n\n|avg_dew_point_poly_1 | 82027.0586| 0|\n\n\n|avg_dew_point_poly_2 | -15137.9168| 0|\n\n\n|avg_solar_rad_poly_1 | 51102.2624| 0|\n\n\n|avg_solar_rad_poly_2 | -8235.8516| 0|\n\n\n\n\n# 5. Fit best model to entire dataset\nbest_model &lt;- workflow_3 |&gt;\n  fit(bike_data)\n\nbest_model |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy() |&gt;\n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n16220.8198\n1566.8989\n10.3521804\n0.0000000\n\n\ntotal_snowfall\n-190.7570\n172.5941\n-1.1052349\n0.2698753\n\n\nseasons_Spring\n-1690.1899\n2238.5953\n-0.7550225\n0.4507822\n\n\nseasons_Summer\n17363.1798\n2967.4304\n5.8512508\n0.0000000\n\n\nseasons_Winter\n-7826.1966\n2435.1785\n-3.2138082\n0.0014413\n\n\nholiday_No.Holiday\n5544.5102\n1455.4134\n3.8095776\n0.0001664\n\n\nweekend_weekend\n-2419.7764\n334.2536\n-7.2393425\n0.0000000\n\n\nseasons_Spring_x_holiday_No.Holiday\n-2795.3406\n2274.2039\n-1.2291513\n0.2199043\n\n\nseasons_Summer_x_holiday_No.Holiday\n-1849.9401\n2460.1365\n-0.7519664\n0.4526155\n\n\nseasons_Winter_x_holiday_No.Holiday\n-3323.2703\n1794.2003\n-1.8522292\n0.0648995\n\n\nseasons_Spring_x_avg_temp\n5038.9305\n939.3334\n5.3643688\n0.0000002\n\n\nseasons_Summer_x_avg_temp\n-16036.3683\n1980.8304\n-8.0957807\n0.0000000\n\n\nseasons_Winter_x_avg_temp\n-4900.0809\n2412.3190\n-2.0312740\n0.0430406\n\n\navg_temp_x_total_rainfall\n-1496.8924\n433.2675\n-3.4548918\n0.0006235\n\n\ntotal_rainfall_poly_1\n-32417.5524\n6810.2605\n-4.7601046\n0.0000029\n\n\ntotal_rainfall_poly_2\n15954.5280\n3451.0152\n4.6231404\n0.0000055\n\n\navg_temp_poly_1\n54046.4000\n69464.3872\n0.7780447\n0.4371087\n\n\navg_temp_poly_2\n-18441.1978\n17021.2263\n-1.0834236\n0.2794236\n\n\navg_humidity_poly_1\n-22486.3905\n24440.7932\n-0.9200352\n0.3582367\n\n\navg_humidity_poly_2\n-7775.2097\n6074.8965\n-1.2798917\n0.2014961\n\n\navg_wind_speed_poly_1\n-8565.4180\n3298.3897\n-2.5968484\n0.0098360\n\n\navg_wind_speed_poly_2\n3234.9063\n3033.6292\n1.0663486\n0.2870576\n\n\navg_visibility_poly_1\n4907.7547\n4295.9116\n1.1424245\n0.2541185\n\n\navg_visibility_poly_2\n-507.1624\n3023.9973\n-0.1677126\n0.8669137\n\n\navg_dew_point_poly_1\n62228.7543\n81037.9071\n0.7678969\n0.4431060\n\n\navg_dew_point_poly_2\n-2609.8231\n11488.1486\n-0.2271753\n0.8204303\n\n\navg_solar_rad_poly_1\n54111.2921\n5653.8611\n9.5706794\n0.0000000\n\n\navg_solar_rad_poly_2\n-6582.7551\n3485.6564\n-1.8885267\n0.0598456"
  }
]